<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia Site Renderer 1.8.1 from org.apache.maven.plugins:maven-pmd-plugin:3.11.0:cpd at 2021-04-21 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Experimental Design Library &#x2013; CPD Results</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta http-equiv="Content-Language" content="en" />
    
  </head>
  <body class="composite">
    <div id="banner">
<div id="bannerLeft">
Experimental Design Library
</div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
      <div class="xleft">
        <span id="publishDate">Last Published: 2021-04-21</span>
          &nbsp;| <span id="projectVersion">Version: 0.20.0-SNAPSHOT</span>
      </div>
      <div class="xright"><a href="./" title="Experimental Design Library">Experimental Design Library</a>      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
       <h5>Project Documentation</h5>
    <ul>
     <li class="collapsed"><a href="project-info.html" title="Project Information">Project Information</a></li>
     <li class="expanded"><a href="project-reports.html" title="Project Reports">Project Reports</a>
      <ul>
       <li class="none"><a href="checkstyle.html" title="Checkstyle">Checkstyle</a></li>
       <li class="none"><strong>CPD</strong></li>
       <li class="none"><a href="pmd.html" title="PMD">PMD</a></li>
       <li class="none"><a href="surefire-report.html" title="Surefire Report">Surefire Report</a></li>
       <li class="none"><a href="apidocs/index.html" title="Javadoc">Javadoc</a></li>
       <li class="none"><a href="xref/index.html" title="Source Xref">Source Xref</a></li>
       <li class="none"><a href="gapidocs/index.html" title="Groovydocs">Groovydocs</a></li>
      </ul></li>
    </ul>
      <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
      </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
<div class="section">
<h2><a name="CPD_Results"></a>CPD Results</h2>
<p>The following document contains the results of PMD's  <a class="externalLink" href="https://pmd.github.io/latest/pmd_userdocs_cpd.html">CPD</a> 6.8.0.</p></div>
<div class="section">
<h2><a name="Duplications"></a>Duplications</h2>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L784">784</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L513">513</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>  }

  private void printSampleLevel(List&lt;ISampleBean&gt; level) {
    logger.info(&quot;###&quot;);
    logger.info(&quot;New Level of Samples:&quot;);
    for (ISampleBean s : level) {
      logger.info(&quot;Sample &quot; + s.getSecondaryName() + &quot; (id: &quot; + s.getCode() + &quot;)&quot;);
      logger.info(&quot;Parents: &quot; + s.getParentIDs());
      logger.info(s.getType());
      logger.info(s.getMetadata());
      logger.info(&quot;#&quot;);
    }
    logger.info(&quot;End of Sample Level&quot;);
  }

  private List&lt;String&gt; parsePoolParents(String poolName) {
    return new ArrayList&lt;&gt;(Arrays.asList(poolName.split(LIST_SEPARATOR)));
  }

  // private Map&lt;String, Object&gt; parseMSExperimentData(String[] row,
  // Map&lt;String, Integer&gt; headerMapping, HashMap&lt;String, Object&gt; metadata) {
  // Map&lt;String, String&gt; designMap = new HashMap&lt;String, String&gt;();
  // designMap.put(&quot;MS Device&quot;, &quot;Q_MS_DEVICE&quot;);
  // designMap.put(&quot;LC Column&quot;, &quot;Q_CHROMATOGRAPHY_TYPE&quot;);
  // designMap.put(&quot;LCMS Method&quot;, &quot;Q_MS_LCMS_METHOD&quot;);
  // for (String col : designMap.keySet()) {
  // Object val = &quot;&quot;;
  // String openbisType = designMap.get(col);
  // if (headerMapping.containsKey(col)) {
  // val = row[headerMapping.get(col)];
  // if (parsers.containsKey(openbisType)) {
  // val = parsers.get(openbisType).parse((String) val);
  // }
  // }
  // metadata.put(openbisType, val);
  // }
  // return metadata;
  // }

  public Set&lt;String&gt; getSpeciesSet() {
    return speciesSet;
  }

  public Set&lt;String&gt; getTissueSet() {
    return tissueSet;
  }

  private boolean checkUniqueIDsBetweenSets(Set&lt;String&gt; speciesSet, Set&lt;String&gt; tissueSet) {
    Set&lt;String&gt; intersection1 = new HashSet&lt;String&gt;(speciesSet);
    intersection1.retainAll(tissueSet);
    if (!intersection1.isEmpty()) {
      error = &quot;Entry &quot; + intersection1.iterator().next()
          + &quot; was found as organism and tissue. It can't be both!&quot;;
      return false;
    }
    return true;
  }

  private String trySplitMetadata(String line, String keyword) {
    try {
      return line.split(keyword)[1].trim();
    } catch (ArrayIndexOutOfBoundsException e) {
      return &quot;&quot;;
    }
  }

  private String replaceSpecials(String s) {
    return s.replace(&quot;%%%&quot;, &quot;#&quot;).replace(&quot;&gt;&gt;&gt;&quot;, &quot;=&quot;);
  }

  private HashMap&lt;String, Object&gt; fillMetadata(String[] header, String[] data, List&lt;Integer&gt; meta,
      Set&lt;Integer&gt; factors, List&lt;Integer&gt; loci, SampleType type) {
    Map&lt;String, List&lt;String&gt;&gt; headersToOpenbisCode = headersToTypeCodePerSampletype.get(type);
    HashMap&lt;String, Object&gt; res = new HashMap&lt;String, Object&gt;();
    if (headersToOpenbisCode != null) {
      for (int i : meta) {
        String label = header[i];
        if (!data[i].isEmpty() &amp;&amp; headersToOpenbisCode.containsKey(label)) {
          for (String propertyCode : headersToOpenbisCode.get(label)) {
            Object val = data[i];
            // if (parsers.containsKey(propertyCode))
            // val = parsers.get(propertyCode).parse(data[i]);
            res.put(propertyCode, val);
          }
        }
      }
    }
    if (factors.size() &gt; 0)

    {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L121">121</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L123">123</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    addValueForCategory(headerMapping, row, &quot;LCMS Method&quot;);
  }

  private void addValueForCategory(Map&lt;String, Integer&gt; headerMapping, String[] row, String cat) {
    if (headerMapping.containsKey(cat)) {
      String val = row[headerMapping.get(cat)];
      if (val != null &amp;&amp; !val.isEmpty()) {
        for (String v : val.split(LIST_SEPARATOR)) {
          if (parsedCategoriesToValues.containsKey(cat)) {
            parsedCategoriesToValues.get(cat).add(v);
          } else {
            Set&lt;String&gt; set = new HashSet&lt;String&gt;();
            set.add(v);
            parsedCategoriesToValues.put(cat, set);
          }
        }
      }
    }
  }

  public Map&lt;String, List&lt;Map&lt;String, Object&gt;&gt;&gt; getExperimentInfos() {
    return experimentInfos;
  }

  private static String removeUTF8BOM(String s) {
    if (s.startsWith(UTF8_BOM)) {
      s = s.substring(1);
    }
    return s;
  }

  /**
   * Reads in a TSV file containing openBIS samples that should be registered. Returns a List of
   * TSVSampleBeans containing all the necessary information to register each sample with its meta
   * information to openBIS, given that the types and parents exist.
   * 
   * @param file
   * @return ArrayList of TSVSampleBeans
   * @throws IOException
   */
  public List&lt;ISampleBean&gt; readSamples(File file, boolean parseGraph) throws IOException {
    tsvByRows = new ArrayList&lt;String&gt;();
    parsedCategoriesToValues = new HashMap&lt;&gt;();

    BufferedReader reader = new BufferedReader(new FileReader(file));
    ArrayList&lt;String[]&gt; data = new ArrayList&lt;String[]&gt;();
    String next;
    int i = 0;
    // isPilot = false;
    while ((next = reader.readLine()) != null) {
      i++;
      next = removeUTF8BOM(next);
      tsvByRows.add(next);
      String[] nextLine = next.split(&quot;\t&quot;, -1);// this is needed for trailing tabs

      if (data.isEmpty() || nextLine.length == data.get(0).length) {
        data.add(nextLine);
      } else {
        error = &quot;Wrong number of columns in row &quot; + i;
        reader.close();
        return null;
      }
    }
    reader.close();

    String[] header = data.get(0);
    String[] trimmedHeader = new String[header.length];
    for (int j = 0; j &lt; header.length; j++) {
      trimmedHeader[j] = header[j].trim();
    }
    header = trimmedHeader;
    data.remove(0);
    // find out where the mandatory and other metadata data is
    Map&lt;String, Integer&gt; headerMapping = new HashMap&lt;&gt;();
    List&lt;Integer&gt; meta = new ArrayList&lt;&gt;();
    Set&lt;Integer&gt; factors = new HashSet&lt;&gt;();
    List&lt;Integer&gt; properties = new ArrayList&lt;&gt;();
    List&lt;Integer&gt; loci = new ArrayList&lt;&gt;();

    ArrayList&lt;String&gt; found = new ArrayList&lt;String&gt;(Arrays.asList(header));
    for (String col : mandatoryColumns) {
      if (!found.contains(col)) {
        error = &quot;Mandatory column &quot; + col + &quot; not found.&quot;;
        return null;
      }
    }
    for (i = 0; i &lt; header.length; i++) {
      int position = mandatoryColumns.indexOf(header[i]);
      if (position == -1)
        position = optionalCols.indexOf(header[i]);
      if (position &gt; -1) {
        headerMapping.put(header[i], i);
        meta.add(i);
      } else if (header[i].contains(&quot;Condition:&quot;)) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L644">644</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L868">868</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
      }
    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {
    return colName.split(&quot;: &quot;)[1];
  }

  public String getError() {
    if (error != null)
      logger.error(error);
    else
      logger.info(&quot;Parsing of experimental design successful.&quot;);
    return error;
  }

  @Override
  public Set&lt;String&gt; getAnalyteSet() {
    return new HashSet&lt;String&gt;(Arrays.asList(&quot;CELL_LYSATE&quot;, &quot;DNA&quot;));</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L645">645</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L424">424</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        res.put(headersToOpenbisCode.get(label), data[i]);
    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {
    return colName.split(&quot;: &quot;)[1];
  }

  public String getError() {
    if (error != null)
      logger.error(error);
    else
      logger.info(&quot;Parsing of experimental design successful.&quot;);
    return error;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L646">646</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L646">646</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L870">870</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {
    return colName.split(&quot;: &quot;)[1];
  }

  public String getError() {
    if (error != null)
      logger.error(error);
    else
      logger.info(&quot;Parsing of experimental design successful.&quot;);
    return error;
  }

  @Override
  public List&lt;String&gt; getTSVByRows() {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L646">646</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L870">870</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L425">425</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {
    return colName.split(&quot;: &quot;)[1];
  }

  public String getError() {
    if (error != null)
      logger.error(error);
    else
      logger.info(&quot;Parsing of experimental design successful.&quot;);
    return error;
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L228">228</a></td></tr>
<tr class="a">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L624">624</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>                unit = Unit.Arbitrary_Unit;
              } finally {
                factor = new Property(factorLabel, factorVal, unit, PropertyType.Factor);
              }
            } else {
              factor = new Property(factorLabel, factorVal, PropertyType.Factor);
            }
            factors.add(factor);
            if (sourceFactorLabels.contains(factorLabel)) {
              sourceFactors.add(factor);
            }
          }
        }
        if (!unknownUnits.isEmpty()) {
          log.warn(unknownUnits);
          log.warn(&quot;Units have been replaced by \&quot;Arbitrary Unit\&quot;&quot;);
        }
        // these will be filled below, if they don't exist
        TSVSampleBean eSample = sampleIDToSample.get(sampleID);
        TSVSampleBean sSample = sourceIDToSample.get(sourceID);
        if (!sampleIDToSample.containsKey(sampleID)) {
          Map&lt;String, Object&gt; metadata = new HashMap&lt;String, Object&gt;();
          metadata.put(&quot;Factors&quot;, factors);
          eSample = new TSVSampleBean(sampleID, SampleType.Q_BIOLOGICAL_SAMPLE, sampleID, metadata);
          eSample.addProperty(&quot;Q_PRIMARY_TISSUE&quot;, tissue);
          eSample.addProperty(&quot;Q_EXTERNALDB_ID&quot;, sampleID);
          sampleIDToSample.put(sampleID, eSample);
          eSample.addParentID(sourceID);

        }
        if (!sourceIDToSample.containsKey(sourceID)) {
          // sampleID++;
          Map&lt;String, Object&gt; metadata = new HashMap&lt;String, Object&gt;();
          metadata.put(&quot;Factors&quot;, sourceFactors);
          sSample = new TSVSampleBean(sourceID, SampleType.Q_BIOLOGICAL_ENTITY, sourceID, metadata);
          sSample.addProperty(&quot;Q_NCBI_ORGANISM&quot;, organism);
          sSample.addProperty(&quot;Q_EXTERNALDB_ID&quot;, sourceID);
          sourceIDToSample.put(sourceID, sSample);
        }
      }

      // for each assay find entities by Names and connect them via Sample Names to existing tissue
      // samples
      int unknownExtractID = 0;
      int uniqueEntityID = 0;
      for (String ass : study.getAssays().keySet()) {
        Assay assay = study.getAssays().get(ass);
        int assaySampleIDCol = findAssayColumnID(assay, &quot;Sample Name&quot;);
        int assayExtractIDCol = findAssayColumnID(assay, &quot;Extract Name&quot;);
        // Analyte
        String endpoint = assay.getMeasurementEndpoint();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L644">644</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L597">597</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>        }
      }
    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L646">646</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L599">599</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L425">425</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    }
    if (factors.size() &gt; 0) {
      String fRes = &quot;&quot;;
      for (int i : factors) {
        if (!data[i].isEmpty()) {
          String values = unitCheck(data[i]);
          fRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + values + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      fRes = fRes.substring(0, Math.max(1, fRes.length()) - 1);
      res.put(&quot;XML_FACTORS&quot;, fRes);
    }
    if (loci.size() &gt; 0) {
      String lRes = &quot;&quot;;
      for (int i : loci) {
        if (!data[i].isEmpty()) {
          lRes += parseXMLPartLabel(header[i]) + &quot;: &quot; + data[i] + &quot;;&quot;;
        }
      }
      // remove trailing &quot;;&quot;
      lRes = lRes.substring(0, Math.max(1, lRes.length()) - 1);
      res.put(&quot;XML_LOCI&quot;, lRes);
    }
    return res;
  }

  private String unitCheck(String string) {
    String[] split = string.split(&quot;:&quot;);
    if (split.length &gt; 2)
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    if (split.length == 2) {
      String unit = split[1].trim();
      for (Unit u : Unit.values()) {
        if (u.getValue().equals(unit))
          return string;
      }
      return string.replace(&quot;:&quot;, &quot; -&quot;);
    }
    return string;
  }

  private String parseXMLPartLabel(String colName) {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L279">279</a></td></tr>
<tr class="b">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L677">677</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        String analyte = getAnalyteFromMeasureEndpoint(endpoint);

        Object[][] assayMatrix = assay.getAssayDataMatrix();
        for (int rowID = 1; rowID &lt; assayMatrix.length; rowID++) {
          String sampleID = (String) assayMatrix[rowID][assaySampleIDCol];
          unknownExtractID++;
          String extractID = Integer.toString(unknownExtractID);
          if (assayExtractIDCol != -1) {
            extractID = extractID + &quot;-&quot; + (String) assayMatrix[rowID][assayExtractIDCol];
          }
          TSVSampleBean eSample = sampleIDToSample.get(sampleID);
          Map&lt;String, Object&gt; metadata = new HashMap&lt;String, Object&gt;();
          metadata.put(&quot;Factors&quot;, eSample.getMetadata().get(&quot;Factors&quot;));
          TSVSampleBean tSample =
              new TSVSampleBean(extractID, SampleType.Q_TEST_SAMPLE, extractID, metadata);

          tSample.addProperty(&quot;Q_SAMPLE_TYPE&quot;, analyte);
          tSample.addProperty(&quot;Q_EXTERNALDB_ID&quot;, extractID);
          analyteIDToSample.put(extractID, tSample);
          tSample.addParentID(sampleID);

          List&lt;TSVSampleBean&gt; sampleRow = new ArrayList&lt;TSVSampleBean&gt;(
              Arrays.asList(sourceIDToSample.get(eSample.getParentIDs().get(0)),
                  sampleIDToSample.get(sampleID), tSample));
          // if (analytesIncluded)
          // sampleRow.add(analyteIDToSample.get(analyteID));
          uniqueEntityID++;
          createGraphSummariesForRow(sampleRow, new Integer(uniqueEntityID));
        }
      }

      Map&lt;String, List&lt;SampleSummary&gt;&gt; nodeListsPerLabel =
          new HashMap&lt;String, List&lt;SampleSummary&gt;&gt;();
      for (String label : nodesForFactorPerLabel.keySet()) {
        nodeListsPerLabel.put(label,
            new ArrayList&lt;SampleSummary&gt;(nodesForFactorPerLabel.get(label)));
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L220">220</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L206">206</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    }
    for (i = 0; i &lt; header.length; i++) {
      int position = mandatoryColumns.indexOf(header[i]);
      if (position == -1)
        position = optionalCols.indexOf(header[i]);
      if (position &gt; -1) {
        headerMapping.put(header[i], i);
        meta.add(i);
      } else if (header[i].contains(&quot;Condition:&quot;)) {
        String condition = header[i].replace(&quot;Condition: &quot;, &quot;&quot;);
        for (char c : condition.toCharArray()) {
          if (Character.isUpperCase(c)) {
            error = &quot;Conditions are not allowed to contain upper case characters: &quot; + condition;
            return null;
          }
        }
        if (condition.contains(&quot; &quot;)) {
          error = &quot;Conditions are not allowed to contain spaces: &quot; + condition;
          return null;
        }
        char first = condition.charAt(0);
        if (first &gt;= '0' &amp;&amp; first &lt;= '9') {
          error = &quot;Conditions are not allowed to start with a number: &quot; + condition;
          return null;
        }
        factors.add(i);
      } else if (header[i].contains(&quot;Locus:&quot;)) {
        loci.add(i);
      } else {
        meta.add(i);
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L216">216</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L221">221</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        for (char c : condition.toCharArray()) {
          if (Character.isUpperCase(c)) {
            error = &quot;Conditions are not allowed to contain upper case characters: &quot; + condition;
            return null;
          }
        }
        if (condition.contains(&quot; &quot;)) {
          error = &quot;Conditions are not allowed to contain spaces: &quot; + condition;
          return null;
        }
        char first = condition.charAt(0);
        if (first &gt;= '0' &amp;&amp; first &lt;= '9') {
          error = &quot;Conditions are not allowed to start with a number: &quot; + condition;
          return null;
        }
        factors.add(i);
      } else if (header[i].contains(&quot;Locus:&quot;)) {
        loci.add(i);
      } else {
        meta.add(i);
      }
    }
    // sort attributes
    Set&lt;Integer&gt; entityFactors = new HashSet&lt;Integer&gt;();
    Set&lt;Integer&gt; extractFactors = new HashSet&lt;Integer&gt;();
    for (int col : factors) {
      Map&lt;String, String&gt; idToVal = new HashMap&lt;String, String&gt;();
      boolean ent = true;
      boolean extr = true;
      for (String[] row : data) {
        String val = row[col];
        String sourceID = row[headerMapping.get(&quot;Organism ID&quot;)];</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L227">227</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L192">192</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        meta.add(i);
      } else if (header[i].contains(&quot;Condition:&quot;)) {
        String condition = header[i].replace(&quot;Condition: &quot;, &quot;&quot;);
        for (char c : condition.toCharArray()) {
          if (Character.isUpperCase(c)) {
            error = &quot;Conditions are not allowed to contain upper case characters: &quot; + condition;
            return null;
          }
        }
        if (condition.contains(&quot; &quot;)) {
          error = &quot;Conditions are not allowed to contain spaces: &quot; + condition;
          return null;
        }
        char first = condition.charAt(0);
        if (first &gt;= '0' &amp;&amp; first &lt;= '9') {
          error = &quot;Conditions are not allowed to start with a number: &quot; + condition;
          return null;
        }
        factors.add(i);
      } else if (header[i].contains(&quot;Locus:&quot;)) {
        loci.add(i);
      } else {
        meta.add(i);
      }
    }
    // create samples
    List&lt;ISampleBean&gt; beans = new ArrayList&lt;ISampleBean&gt;();
    List&lt;List&lt;ISampleBean&gt;&gt; order = new ArrayList&lt;List&lt;ISampleBean&gt;&gt;();</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L165">165</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L332">332</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      metadata.remove(&quot;Factors&quot;);

      // other parsers
      if (metadata.get(&quot;XML_FACTORS&quot;) != null) {
        String[] fStrings = SEMICOLON.split((String) metadata.get(&quot;XML_FACTORS&quot;));
        for (String factor : fStrings) {
          if (factor.length() &gt; 1) {
            String[] fields = COLON.split(factor);
            for (int i = 0; i &lt; fields.length; i++)
              fields[i] = fields[i].trim();
            Matcher matcher = WHITESPACE.matcher(fields[0]);
            String lab = matcher.replaceAll(&quot;&quot;);
            String val = fields[1];
            if (fields.length &gt; 2)
              props.add(new Property(lab, val, Unit.valueOf(fields[2]), PropertyType.Factor));
            else
              props.add(new Property(lab, val, PropertyType.Factor));
          }
        }
      }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L514">514</a></td></tr>
<tr class="b">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L465">465</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>    Property factor = getFactorOfSampleOrNull((List&lt;Property&gt;) props.get(&quot;Q_PROPERTIES&quot;), label);

    // Property factor = getFactorOfSampleOrNull(factors, label);
    boolean newFactor = true;
    Set&lt;String&gt; parentSources = new HashSet&lt;String&gt;();
    Set&lt;Integer&gt; parentIDs = new HashSet&lt;Integer&gt;();
    for (SampleSummary parentSum : parents) {
      parentIDs.add(parentSum.getId());
      String factorVal = parentSum.getFactorValue();
      if (factorVal != null &amp;&amp; !factorVal.isEmpty()) {
        newFactor = false;
      }
      parentSources.add(parentSum.getSource());
    }
    if (factor == null) {
      factor = new Property(&quot;parents&quot;, String.join(&quot;+&quot;, parentSources), PropertyType.Factor);// TODO
                                                                                             // makes
                                                                                             // sense?
      newFactor = false;
    }
    String value = &quot;&quot;;
    if (newFactor)
      value = factor.getValue();
    switch (type) {
      case Q_BIOLOGICAL_ENTITY:
        source = (String) props.get(&quot;Q_NCBI_ORGANISM&quot;);
        value = source + &quot; &quot; + value;</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L213">213</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L192">192</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        meta.add(i);
      } else if (header[i].contains(&quot;Condition:&quot;)) {
        String condition = header[i].replace(&quot;Condition: &quot;, &quot;&quot;);
        for (char c : condition.toCharArray()) {
          if (Character.isUpperCase(c)) {
            error = &quot;Conditions are not allowed to contain upper case characters: &quot; + condition;
            return null;
          }
        }
        if (condition.contains(&quot; &quot;)) {
          error = &quot;Conditions are not allowed to contain spaces: &quot; + condition;
          return null;
        }
        char first = condition.charAt(0);
        if (first &gt;= '0' &amp;&amp; first &lt;= '9') {
          error = &quot;Conditions are not allowed to start with a number: &quot; + condition;
          return null;
        }
        factors.add(i);
      } else if (header[i].contains(&quot;Locus:&quot;)) {
        loci.add(i);
      } else {
        meta.add(i);
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L171">171</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L163">163</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L165">165</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    tsvByRows = new ArrayList&lt;String&gt;();

    BufferedReader reader = new BufferedReader(new FileReader(file));
    ArrayList&lt;String[]&gt; data = new ArrayList&lt;String[]&gt;();
    String next;
    int i = 0;
    // isPilot = false;
    while ((next = reader.readLine()) != null) {
      i++;
      next = removeUTF8BOM(next);
      tsvByRows.add(next);
      String[] nextLine = next.split(&quot;\t&quot;, -1);// this is needed for trailing tabs
      if (data.isEmpty() || nextLine.length == data.get(0).length) {
        data.add(nextLine);
      } else {
        error = &quot;Wrong number of columns in row &quot; + i;
        reader.close();
        return null;
      }
    }
    reader.close();

    String[] header = data.get(0);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L98">98</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L177">177</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    Set&lt;String&gt; ids = new HashSet&lt;String&gt;();
    nodesForFactorPerLabel = new HashMap&lt;String, Set&lt;SampleSummary&gt;&gt;();

    tsvByRows = new ArrayList&lt;String&gt;();
    BufferedReader reader = new BufferedReader(new FileReader(file));
    ArrayList&lt;String[]&gt; data = new ArrayList&lt;String[]&gt;();
    String next;
    int i = 0;
    // isPilot = false;
    while ((next = reader.readLine()) != null) {
      i++;
      next = ParserHelpers.removeUTF8BOM(next);
      tsvByRows.add(next);
      String[] nextLine = next.split(&quot;\t&quot;, -1);// this is needed for trailing tabs
      if (data.isEmpty() || nextLine.length == data.get(0).length) {
        data.add(nextLine);
      } else {</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L164">164</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L286">286</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>      }
      metadata.remove(&quot;Factors&quot;);

      // other parsers
      if (metadata.get(&quot;XML_FACTORS&quot;) != null) {
        String[] fStrings = SEMICOLON.split((String) metadata.get(&quot;XML_FACTORS&quot;));
        for (String factor : fStrings) {
          if (factor.length() &gt; 1) {
            String[] fields = COLON.split(factor);
            for (int i = 0; i &lt; fields.length; i++)
              fields[i] = fields[i].trim();
            Matcher matcher = WHITESPACE.matcher(fields[0]);
            String lab = matcher.replaceAll(&quot;&quot;);
            String val = fields[1];
            if (fields.length &gt; 2)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L287">287</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/ParserHelpers.java</td>
<td><a href="./xref/life/qbic/expdesign/ParserHelpers.html#L332">332</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>    metadata.remove(&quot;Factors&quot;);

    if (metadata.get(&quot;XML_FACTORS&quot;) != null) {
      String[] fStrings = SEMICOLON.split((String) metadata.get(&quot;XML_FACTORS&quot;));
      for (String factor : fStrings) {
        if (factor.length() &gt; 1) {
          String[] fields = COLON.split(factor);
          for (int i = 0; i &lt; fields.length; i++)
            fields[i] = fields[i].trim();
          Matcher matcher = WHITESPACE.matcher(fields[0]);
          String lab = matcher.replaceAll(&quot;&quot;);
          String val = fields[1];
          if (fields.length &gt; 2)</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L437">437</a></td></tr>
<tr class="a">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L422">422</a></td></tr>
<tr class="b"><td colspan='2'>
<div>
<pre>          currentSummary = createNodeSummary(s, parentSummaries, label, locNodeID, leaf);
          // check for hashcode and add current sample s if node exists
          boolean exists = false;
          for (SampleSummary oldNode : nodesForFactorPerLabel.get(label)) {
            if (oldNode.equals(currentSummary)) {
              for (String code : currentSummary.getCodes()) {
                exists = oldNode.getCodes().contains(code);
              }
              if (!exists)
                oldNode.addSample(s);
              currentSummary = oldNode;
            }
          }
          // adds node if not already contained in set
          Set&lt;SampleSummary&gt; theseNodes = nodesForFactorPerLabel.get(label);
          theseNodes.add(currentSummary);
          nodesForFactorPerLabel.put(label, theseNodes);
          // add this id to parents' child ids
          for (SampleSummary parentSummary : parentSummaries) {
            parentSummary.addChildID(currentSummary.getId());
          }
        }
      }
    }
  }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="a">
<th>File</th>
<th>Line</th></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MHCLigandDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MHCLigandDesignReader.html#L230">230</a></td></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L221">221</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/QBiCDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/QBiCDesignReader.html#L195">195</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        for (char c : condition.toCharArray()) {
          if (Character.isUpperCase(c)) {
            error = &quot;Conditions are not allowed to contain upper case characters: &quot; + condition;
            return null;
          }
        }
        if (condition.contains(&quot; &quot;)) {
          error = &quot;Conditions are not allowed to contain spaces: &quot; + condition;
          return null;
        }
        char first = condition.charAt(0);
        if (first &gt;= '0' &amp;&amp; first &lt;= '9') {
          error = &quot;Conditions are not allowed to start with a number: &quot; + condition;
          return null;
        }
        factors.add(i);
      } else if (header[i].contains(&quot;Locus:&quot;)) {
        loci.add(i);
      } else {
        meta.add(i);
      }
    }</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L254">254</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MetaboDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MetaboDesignReader.html#L260">260</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>        if (idToVal.containsKey(sourceID)) {
          if (!idToVal.get(sourceID).equals(val))
            ent = false;
        }
        if (idToVal.containsKey(extractID)) {
          if (!idToVal.get(extractID).equals(val))
            extr = false;
        }
        idToVal.put(sourceID, val);
        idToVal.put(extractID, val);
      }
      if (ent)
        entityFactors.add(col);
      if (extr)
        extractFactors.add(col);
    }
    // if (parseGraph) {
    // for (int factorCol : factors) {
    // String label = parseXMLPartLabel(header[factorCol]);
    // nodesForFactorPerLabel.put(label, new LinkedHashSet&lt;SampleSummary&gt;());
    // }
    // nodesForFactorPerLabel.put(&quot;None&quot;, new LinkedHashSet&lt;SampleSummary&gt;());
    // }
    // create samples
    List&lt;ISampleBean&gt; beans = new ArrayList&lt;&gt;();

    // worst case order of samples (hierarchy):
    // organism - tissue - protein - peptide - protein pool - peptides of pool - protein
    // fractions/cycles - peptides of fractions/cycles - pool of fractions - peptides of pool - ms
    // measurements
    List&lt;MassSpecSampleHierarchy&gt; order =</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L192">192</a></td></tr>
<tr class="b">
<td>life/qbic/isatab/ISAReader.java</td>
<td><a href="./xref/life/qbic/isatab/ISAReader.html#L588">588</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      nodesForFactorPerLabel.put(&quot;None&quot;, new LinkedHashSet&lt;&gt;());
      Set&lt;String&gt; sourceFactorLabels = getFactorsForSources(study);

      Object[][] matrix = study.getStudySampleDataMatrix();
      for (int rowID = 1; rowID &lt; matrix.length; rowID++) {
        String organism = &quot;unspecified species&quot;;
        if (organismCol != -1)
          organism = removeOntologyPrefix((String) matrix[rowID][organismCol]);
        String tissue = &quot;unspecified organ&quot;;
        if (organCol != -1)
          tissue = removeOntologyPrefix((String) matrix[rowID][organCol]);
        organism = mapper.translate(organism);
        tissue = mapper.translate(tissue);</pre></div></td></tr></table>
<table border="0" class="bodyTable">
<tr class="b">
<th>File</th>
<th>Line</th></tr>
<tr class="a">
<td>life/qbic/expdesign/io/EasyDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/EasyDesignReader.html#L273">273</a></td></tr>
<tr class="b">
<td>life/qbic/expdesign/io/MSDesignReader.java</td>
<td><a href="./xref/life/qbic/expdesign/io/MSDesignReader.html#L234">234</a></td></tr>
<tr class="a"><td colspan='2'>
<div>
<pre>      } else {
        meta.add(i);
      }
    }
    // sort attributes
    Set&lt;Integer&gt; entityFactors = new HashSet&lt;Integer&gt;();
    Set&lt;Integer&gt; extractFactors = new HashSet&lt;Integer&gt;();
    for (int col : factors) {
      Map&lt;String, String&gt; idToVal = new HashMap&lt;String, String&gt;();
      boolean ent = true;
      boolean extr = true;
      for (String[] row : data) {
        String val = row[col];
        String sourceID = row[headerMapping.get(&quot;Organism ID&quot;)];
        String extractID = row[headerMapping.get(&quot;Extract ID&quot;)];</pre></div></td></tr></table></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        Copyright &#169;      2021.All rights reserved.      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
